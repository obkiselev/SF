Denis Shustov Feb 25th at 10:29 AM
Добрый день! Вопрос по организации сервера к заданию по фильтрации спама. Классификатор организовал в виде отдельного класса. Далее, в файле run обучаю экземпляр класса. И вот когда в routes вновь импортирую класс и создаю экземпляр, он создается новый, не обученный, соответственно, не работает как нужно. Подскажите, как наладить взаимодействие в этом случае. То есть, каким-то образом нужно передать экземпляр класса из run в routes.
14 replies

Valery Lazarev  1 month ago
Я прокидывал train_data вместе с классом и на старте сервера делал classifier.train(train_data)
Можно натренировать инстанс класса, сериализовать его в pickle и потом грузить pickle на старте сервера. Других вариантов не знаю, делитесь.

Alex Lekov  1 month ago
Сделать класс, Натренировать, сохранить результат через pickle. При запуске сервера подгружать обученный классификатор через pickle.

Denis Shustov  1 month ago
@Alex Lekov то есть организовать все через внешний файл?

Arthur Akhmadishin:speech_balloon:  1 month ago
О, получилось! работает!

Denis Shustov  1 month ago
@Arthur Akhmadishin Вы делали через классы?

Denis Shustov  1 month ago
Сделал через внешний файл. Работает.

Arthur Akhmadishin:speech_balloon:  1 month ago
Да. Сделал, как сказал Алекс, в run сохранил, используя pickle.dump. А затес в routes уже сделал pickle.load

Arthur Akhmadishin:speech_balloon:  1 month ago
Один фиг, ответы классификатора не совпадают с ответами из задания, что в 2.9, что в 2.3.
Что я только не делала!!!1(с)

Alex Lekov  1 month ago
@Denis Shustov да, принято разбивать на файлы отдельные модули программы. Так потом проще с ней работать и поддерживать.

Denis Shustov  1 month ago
@Alex Lekov я про то, что не совсем хорошо делать обмен информацией между модулями через внешний текстовый файл pickle. Будем надеяться на то, что это не замедлит работу программы.

Alex Lekov  1 month ago
@Denis Shustov в данной ситуации это не так. Тут обмена данными нету. Вы один раз обучили модель и забыли про это. Заодно зафиксировали саму модель и её результаты.
А вот обучать модель при каждом запуске - это точно не логично и даже опасно! (edited) 

Denis Shustov  1 month ago
@Alex Lekov Согласен (edited) 

Denis Shustov  1 month ago
@Arthur Akhmadishin у меня совпадет с ответами 1 и 3 в задании 2.9. Письмо 2 у меня определяется как 100% не спам, что не соответствует ответам.

Evgeniy  28 days ago
Тоже бился с этой проблемой - вот такое решение нашел - без файла
Это в РАН обучение
def train():
    spam_class = calc_spam()
    train_data = [
        ['Купите новое чистящее средство', "SPAM"],
        ['Купи мою новую книгу', "SPAM"],
        ['Подари себе новый телефон', "SPAM"],
        ['Добро пожаловать и купите новый телевизор', "SPAM"],
        ['Привет давно не виделись', "NOT_SPAM"],
        ['Довезем до аэропорта из пригорода всего за 399 рублей', "SPAM"],
        ['Добро пожаловать в Мой Круг', "NOT_SPAM"],
        ['Я все еще жду документы', "NOT_SPAM"],
        ['Приглашаем на конференцию Data Science', "NOT_SPAM"],
        ['Потерял твой телефон напомни', "NOT_SPAM"],
        ['Порадуй своего питомца новым костюмом', "SPAM"]
    ]
    for info in train_data:
        spam_class.train(info[0], info[1])
    return spam_class
А потом в импорте из памяти вот так вытащил
import run
и вот так обращался
run.train().classify(text)