Alexander May 16th at 11:34 PM
CatBoost
играюсь с параметрами алгоритма и выявилась такая особенность:
если в регрессор забить категориальные фичи (cat_features) в виде списка, то считает и дольше и с худшим результатом. Если категориальные фичи  перевести в численные и убрать из модели cat_features, то и считает быстрее и MAPЕ лучше. В моем понимании , так быть не должно. Где я делаю ошибку? Код фрагмента модели ниже:
cat_features = ['brand',
 'color',
 'fuelType',
 'vehicleConfiguration',
 'engineDisplacement',
 'Привод',
 'Руль',
 'ПТС',
 'doors',
 'body',
 'four_wd',
 'drive',
 'transmition'
]
model = CatBoostRegressor(iterations = 20000,
                          learning_rate = 0.1,
                          random_seed = random_state,
                          eval_metric='MAPE',
                          custom_metric=['R2', 'MAE'],
                          l2_leaf_reg = 3,                         
                          baggin_temperature = 1 
                         )
model.fit(X_train, y_train,
         #cat_features=cat_features, 
         eval_set=(X_test, y_test),
         verbose_eval=100,
         use_best_model=True,
         plot=True
         )
(edited)
6 replies

Ivan Pushin  1 month ago
Я обычно передаю числовые индексы категориальных признаков как cat_index = np.where(X.dtypes == 'object')[0] Так же в тьюториалах катбуст рекомендуется делать. Не уверен правда, что это будет отличаться от твоего результата (по сути у тебя то же самое индексирование только через название колонок с категориальными данными)

Эмма  1 month ago
@Anton Dorozhko [Mentor Real DS (DST7) ] подскажи пожалуйста

Anton Dorozhko [Mentor Real DS (DST7) ]  1 month ago
@Alexander
Я могу дать только общие комментарии, если этот спецэффект в них не укладывается, то надо спросить у постоянных пользователей catboost.
Если категориальные фичи перевести в численные и убрать из модели cat_features, то и считает быстрее и MAPЕ лучше 
Насчет быстрее  : если вы сами переводите их в численные, то catboost не надо это делать, в этом смысле конечно быстрее.
MAPЕ лучше :  если это хорошая оценка от кроссвалидации, то можно смотреть какие алгоритмы преобразования catboost делает для категориальных признаков и сделать предположения, почему одно лучше другого.

Alex Lekov  1 month ago
Грубо говоря если catboostу не указывать какие фитчи категориальные - он сам их попытается определить. Если ваша фитча имеет много уникальных значений - то она не попадет в это автораспределение как категориальная. Чем больше уникальных значений - тем долше идет таргет кодирование этого признака что сказывается на скорости работы.
:+1:
1


Alex Lekov  1 month ago
В Итоге алгоритм тратит время и ветки своего решения на работу с признаком который не так важен для качественного решения. По этому результат без этого признака получаеться лучше.

Alex Lekov  1 month ago
Рекомендую к просмотру лекцию по catboost что дал в базовом решение - будет понятней как он работает и что с ним делать в том или ином случае.